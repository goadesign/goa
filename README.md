# v2

This branch is work in progress for goa v2.

v2 brings a host of fixes and has a cleaner more composable overall design. Most
notably the DSL engine assumes less about the DSL and is thus more generic. The
top level design package is also hugely simplified to focus solely on the core
DSL expressions.

The import path for goa v2 has changed from `github.com/goadesign/goa` to
`goa.design/goa.v2`.

## Multiple Transport Support

The new top level `rest` package implement the DSL, design objects, code
generation and runtime support for HTTP/REST APIs. The REST DSL is built on top
of the core DSL package and add transport specific keywords to describe aspects
specific to HTTP requests and responses. This structure makes it possible to add
support for other transports especially gRPC.
See
[goa v2 Design Requirements](https://github.com/goadesign/goa/blob/v2/REQ_DESIGN.md).

## New Data Types

The primitive types now include `Int`, `Int32`, `Int64`, `UInt` `UInt32`,
`UInt64`, `Float32`, `Float64` and `Bytes`. This makes it possible to support
transports such as gRPC but also makes REST interface definitions crisper. The
v1 types `Integer` and `Float` have been removed in favor of these new types.

## Composable Code Generation

Code generation now follows a 2-phase process where the first phase produces a
set of writers each exposing templates that can be further modified prior to
running the last phase which generates the final artefacts. This makes it
possible for plugins to alter the code generated by the built-in code
generators, see
the
[Code Generation Requirements](https://github.com/goadesign/goa/blob/v2/REQ_CODEGEN.md).

## Separation of Concern

The generated code produced by `goagen` v2 implements a much stronger separation
of concern between the transport and service layers. This makes it possible to
easily expose the same endpoints via different transport mechanisms such as HTTP
and gRPC. See the
[account example](https://github.com/goadesign/goa/tree/v2/examples/account)
which illustrates the new generated code structure.

## Getting Started

v2 is work in progress. The code is **not** in a usable state (in particular the
code generators are not done yet). However:

* The core and rest DSLs should be fairly stable, see:
  - The [core API DSL spec](https://github.com/goadesign/goa/blob/v2/dsl/_spec/dsl_spec_test.go)
  - The [type DSL spec](https://github.com/goadesign/goa/blob/v2/dsl/_spec/type_spec_test.go)
  - The [rest DSL spec](https://github.com/goadesign/goa/blob/v2/dsl/rest/_spec/dsl_spec_test.go)

* The account example should give a good sense of what the generated code will
  look like, see:
  - The [design](https://github.com/goadesign/goa/blob/v2/examples/account/design/design.go)
  - The [main scaffold](https://github.com/goadesign/goa/blob/v2/examples/account/cmd/basic/main.go)
  - The [generated service](https://github.com/goadesign/goa/blob/v2/examples/account/gen/services/account.go)
  - The [generated endpoints](https://github.com/goadesign/goa/blob/v2/examples/account/gen/endpoints/account.go)
  - The [generated HTTP transport](https://github.com/goadesign/goa/tree/v2/examples/account/gen/transport/http)

## Getting Involved

Ping us on [slack](https://gophers.slack.com/messages/goa/) or open an issue
tagged with `v2` if you have feedback on the above or would like to contribute.
One area that might be interesting to look at may be to write what the
generated code would be for the gRPC transport.
