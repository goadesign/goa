// Code generated by goa v2.0.0-wip, DO NOT EDIT.
//
// sommelier service
//
// Command:
// $ goa gen goa.design/goa/examples/cellar/design -o
// $(GOPATH)/src/goa.design/goa/examples/cellar

package sommelier

import (
	"context"

	sommelierviews "goa.design/goa/examples/cellar/gen/sommelier/views"
)

// The sommelier service retrieves bottles given a set of criteria.
type Service interface {
	// Pick implements pick.
	// The "view" return value must have one of the following views
	// * "tiny"
	// * "default"
	Pick(context.Context, *Criteria) (res StoredBottleCollection, view string, err error)
}

// ServiceName is the name of the service as defined in the design. This is the
// same value that is set in the endpoint request contexts under the ServiceKey
// key.
const ServiceName = "sommelier"

// MethodNames lists the service method names as defined in the design. These
// are the same values that are set in the endpoint request contexts under the
// MethodKey key.
var MethodNames = [1]string{"pick"}

// Criteria is the payload type of the sommelier service pick method.
type Criteria struct {
	// Name of bottle to pick
	Name *string
	// Varietals in preference order
	Varietal []string
	// Winery of bottle to pick
	Winery *string
}

// StoredBottleCollection is the result type of the sommelier service pick
// method.
type StoredBottleCollection []*StoredBottle

// A StoredBottle describes a bottle retrieved by the storage service.
type StoredBottle struct {
	// ID is the unique id of the bottle.
	ID string
	// Name of bottle
	Name string
	// Winery that produces wine
	Winery *Winery
	// Vintage of bottle
	Vintage uint32
	// Composition is the list of grape varietals and associated percentage.
	Composition []*Component
	// Description of bottle
	Description *string
	// Rating of bottle from 1 (worst) to 5 (best)
	Rating *uint32
}

type Winery struct {
	// Name of winery
	Name string
	// Region of winery
	Region string
	// Country of winery
	Country string
	// Winery website URL
	URL *string
}

type Component struct {
	// Grape varietal
	Varietal string
	// Percentage of varietal in wine
	Percentage *uint32
}

// Missing criteria
type NoCriteria string

// No bottle matched given criteria
type NoMatch string

// Error returns an error description.
func (e NoCriteria) Error() string {
	return "Missing criteria"
}

// ErrorName returns "no_criteria".
func (e NoCriteria) ErrorName() string {
	return "no_criteria"
}

// Error returns an error description.
func (e NoMatch) Error() string {
	return "No bottle matched given criteria"
}

// ErrorName returns "no_match".
func (e NoMatch) ErrorName() string {
	return "no_match"
}

// NewStoredBottleCollection converts viewed result type StoredBottleCollection
// to result type StoredBottleCollection.
func NewStoredBottleCollection(vres sommelierviews.StoredBottleCollection) StoredBottleCollection {
	res := make(StoredBottleCollection, len(vres))
	for i, n := range vres {
		res[i] = NewStoredBottle(n)
	}
	return res
}

// NewStoredBottleCollectionTiny projects result type StoredBottleCollection
// into viewed result type StoredBottleCollection using the tiny view.
func NewStoredBottleCollectionTiny(res StoredBottleCollection) sommelierviews.StoredBottleCollection {
	vres := make(sommelierviews.StoredBottleCollection, len(res))
	for i, n := range res {
		vres[i] = NewStoredBottleTiny(n)
	}
	return vres
}

// NewStoredBottleCollectionDefault projects result type StoredBottleCollection
// into viewed result type StoredBottleCollection using the default view.
func NewStoredBottleCollectionDefault(res StoredBottleCollection) sommelierviews.StoredBottleCollection {
	vres := make(sommelierviews.StoredBottleCollection, len(res))
	for i, n := range res {
		vres[i] = NewStoredBottleDefault(n)
	}
	return vres
}

// NewStoredBottle converts viewed result type StoredBottle to result type
// StoredBottle.
func NewStoredBottle(vres *sommelierviews.StoredBottle) *StoredBottle {
	res := &StoredBottle{
		Description: vres.Projected.Description,
		Rating:      vres.Projected.Rating,
	}
	if vres.Projected.ID != nil {
		res.ID = *vres.Projected.ID
	}
	if vres.Projected.Name != nil {
		res.Name = *vres.Projected.Name
	}
	if vres.Projected.Vintage != nil {
		res.Vintage = *vres.Projected.Vintage
	}
	if vres.Projected.Composition != nil {
		res.Composition = make([]*Component, len(vres.Projected.Composition))
		for j, val := range vres.Projected.Composition {
			res.Composition[j] = &Component{
				Percentage: val.Percentage,
			}
			if val.Varietal != nil {
				res.Composition[j].Varietal = *val.Varietal
			}
		}
	}
	if vres.Projected.Winery != nil {
		res.Winery = NewWinery(vres.Projected.Winery)
	}
	return res
}

// NewStoredBottleTiny projects result type StoredBottle into viewed result
// type StoredBottle using the tiny view.
func NewStoredBottleTiny(res *StoredBottle) *sommelierviews.StoredBottle {
	vres := &sommelierviews.StoredBottleView{
		ID:   &res.ID,
		Name: &res.Name,
	}
	if res.Winery != nil {
		vres.Winery = NewWineryTiny(res.Winery)
	}
	return &sommelierviews.StoredBottle{vres, "tiny"}
}

// NewStoredBottleDefault projects result type StoredBottle into viewed result
// type StoredBottle using the default view.
func NewStoredBottleDefault(res *StoredBottle) *sommelierviews.StoredBottle {
	vres := &sommelierviews.StoredBottleView{
		ID:          &res.ID,
		Name:        &res.Name,
		Vintage:     &res.Vintage,
		Description: res.Description,
		Rating:      res.Rating,
	}
	if res.Composition != nil {
		vres.Composition = make([]*sommelierviews.Component, len(res.Composition))
		for j, val := range res.Composition {
			vres.Composition[j] = &sommelierviews.Component{
				Varietal:   &val.Varietal,
				Percentage: val.Percentage,
			}
		}
	}
	if res.Winery != nil {
		vres.Winery = NewWineryTiny(res.Winery)
	}
	return &sommelierviews.StoredBottle{vres, "default"}
}

// NewWinery converts viewed result type Winery to result type Winery.
func NewWinery(vres *sommelierviews.Winery) *Winery {
	res := &Winery{
		URL: vres.Projected.URL,
	}
	if vres.Projected.Name != nil {
		res.Name = *vres.Projected.Name
	}
	if vres.Projected.Region != nil {
		res.Region = *vres.Projected.Region
	}
	if vres.Projected.Country != nil {
		res.Country = *vres.Projected.Country
	}
	return res
}

// NewWineryTiny projects result type Winery into viewed result type Winery
// using the tiny view.
func NewWineryTiny(res *Winery) *sommelierviews.Winery {
	vres := &sommelierviews.WineryView{
		Name: &res.Name,
	}
	return &sommelierviews.Winery{vres, "tiny"}
}

// NewWineryDefault projects result type Winery into viewed result type Winery
// using the default view.
func NewWineryDefault(res *Winery) *sommelierviews.Winery {
	vres := &sommelierviews.WineryView{
		Name:    &res.Name,
		Region:  &res.Region,
		Country: &res.Country,
		URL:     res.URL,
	}
	return &sommelierviews.Winery{vres, "default"}
}
