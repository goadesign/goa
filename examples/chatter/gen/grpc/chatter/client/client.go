// Code generated by goa v2.0.0-wip, DO NOT EDIT.
//
// chatter GRPC client
//
// Command:
// $ goa gen goa.design/goa/examples/chatter/design -o
// $(GOPATH)/src/goa.design/goa/examples/chatter

package client

import (
	"context"

	goa "goa.design/goa"
	chattersvc "goa.design/goa/examples/chatter/gen/chatter"
	chattersvcviews "goa.design/goa/examples/chatter/gen/chatter/views"
	"goa.design/goa/examples/chatter/gen/grpc/chatter/pb"
	goagrpc "goa.design/goa/grpc"
	"google.golang.org/grpc"
)

// Client lists the service endpoint gRPC clients.
type Client struct {
	grpccli pb.ChatterClient
	opts    []grpc.CallOption
}

// echoerClientStream implements the chattersvc.EchoerClientStream.%!s(MISSING)
// interface.
type echoerClientStream struct {
	stream pb.Chatter_EchoerClient
}

// listenerClientStream implements the
// chattersvc.ListenerClientStream.%!s(MISSING) interface.
type listenerClientStream struct {
	stream pb.Chatter_ListenerClient
}

// summaryClientStream implements the
// chattersvc.SummaryClientStream.%!s(MISSING) interface.
type summaryClientStream struct {
	stream pb.Chatter_SummaryClient
	view   string
}

// historyClientStream implements the
// chattersvc.HistoryClientStream.%!s(MISSING) interface.
type historyClientStream struct {
	stream pb.Chatter_HistoryClient
	view   string
}

// NewClient instantiates gRPC client for all the chatter service servers.
func NewClient(cc *grpc.ClientConn, opts ...grpc.CallOption) *Client {
	return &Client{
		grpccli: pb.NewChatterClient(cc),
		opts:    opts,
	}
}

// Login calls the "Login" function in pb.ChatterClient interface.
func (c *Client) Login() goa.Endpoint {
	return func(ctx context.Context, v interface{}) (interface{}, error) {
		inv := goagrpc.NewInvoker(
			BuildLoginFunc(c.grpccli, c.opts...),
			EncodeLoginRequest,
			DecodeLoginResponse)
		res, err := inv.Invoke(ctx, v)
		if err != nil {
			return nil, goagrpc.DecodeError(err)
		}
		return res, nil
	}
}

// Echoer calls the "Echoer" function in pb.ChatterClient interface.
func (c *Client) Echoer() goa.Endpoint {
	return func(ctx context.Context, v interface{}) (interface{}, error) {
		inv := goagrpc.NewInvoker(
			BuildEchoerFunc(c.grpccli, c.opts...),
			EncodeEchoerRequest,
			DecodeEchoerResponse)
		res, err := inv.Invoke(ctx, v)
		if err != nil {
			return nil, goagrpc.DecodeError(err)
		}
		return res, nil
	}
}

// Listener calls the "Listener" function in pb.ChatterClient interface.
func (c *Client) Listener() goa.Endpoint {
	return func(ctx context.Context, v interface{}) (interface{}, error) {
		inv := goagrpc.NewInvoker(
			BuildListenerFunc(c.grpccli, c.opts...),
			EncodeListenerRequest,
			DecodeListenerResponse)
		res, err := inv.Invoke(ctx, v)
		if err != nil {
			return nil, goagrpc.DecodeError(err)
		}
		return res, nil
	}
}

// Summary calls the "Summary" function in pb.ChatterClient interface.
func (c *Client) Summary() goa.Endpoint {
	return func(ctx context.Context, v interface{}) (interface{}, error) {
		inv := goagrpc.NewInvoker(
			BuildSummaryFunc(c.grpccli, c.opts...),
			EncodeSummaryRequest,
			DecodeSummaryResponse)
		res, err := inv.Invoke(ctx, v)
		if err != nil {
			return nil, goagrpc.DecodeError(err)
		}
		return res, nil
	}
}

// History calls the "History" function in pb.ChatterClient interface.
func (c *Client) History() goa.Endpoint {
	return func(ctx context.Context, v interface{}) (interface{}, error) {
		inv := goagrpc.NewInvoker(
			BuildHistoryFunc(c.grpccli, c.opts...),
			EncodeHistoryRequest,
			DecodeHistoryResponse)
		res, err := inv.Invoke(ctx, v)
		if err != nil {
			return nil, goagrpc.DecodeError(err)
		}
		return res, nil
	}
}

// Recv reads instances of "pb.EchoerResponse" from the "echoer" endpoint gRPC
// stream.
func (s *echoerClientStream) Recv() (string, error) {
	var res string
	v, err := s.stream.Recv()
	if err != nil {
		return res, err
	}
	return NewEchoerResponse(v), nil
}

// Send streams instances of "pb.EchoerStreamingRequest" to the "echoer"
// endpoint gRPC stream.
func (s *echoerClientStream) Send(res string) error {
	v := NewEchoerStreamingRequest(res)
	return s.stream.Send(v)
}

func (s *echoerClientStream) Close() error {
	// nothing to do here
	return nil
}

// Send streams instances of "pb.ListenerStreamingRequest" to the "listener"
// endpoint gRPC stream.
func (s *listenerClientStream) Send(res string) error {
	v := NewListenerStreamingRequest(res)
	return s.stream.Send(v)
}

func (s *listenerClientStream) Close() error {
	// nothing to do here
	return nil
}

// CloseAndRecv reads instances of "pb.ChatSummaryCollection" from the
// "summary" endpoint gRPC stream.
func (s *summaryClientStream) CloseAndRecv() (chattersvc.ChatSummaryCollection, error) {
	var res chattersvc.ChatSummaryCollection
	v, err := s.stream.CloseAndRecv()
	if err != nil {
		return res, err
	}
	proj := NewChatSummaryCollection(v)
	vres := chattersvcviews.ChatSummaryCollection{Projected: proj, View: "default"}
	return chattersvc.NewChatSummaryCollection(vres), nil
}

// Send streams instances of "pb.SummaryStreamingRequest" to the "summary"
// endpoint gRPC stream.
func (s *summaryClientStream) Send(res string) error {
	v := NewSummaryStreamingRequest(res)
	return s.stream.Send(v)
}

// Recv reads instances of "pb.HistoryResponse" from the "history" endpoint
// gRPC stream.
func (s *historyClientStream) Recv() (*chattersvc.ChatSummary, error) {
	var res *chattersvc.ChatSummary
	v, err := s.stream.Recv()
	if err != nil {
		return res, err
	}
	proj := NewChatSummaryView(v)
	vres := &chattersvcviews.ChatSummary{Projected: proj, View: s.view}
	return chattersvc.NewChatSummary(vres), nil
}

func (s *historyClientStream) Close() error {
	// nothing to do here
	return nil
}

// SetView sets the view.
func (s *historyClientStream) SetView(view string) {
	s.view = view
}
